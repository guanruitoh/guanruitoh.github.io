<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>My Purchase</title>
    <style>
        @import url(//cdnjs.cloudflare.com/ajax/libs/normalize/3.0.1/normalize.min.css);
        @import url(//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css);
    </style>
    <!-- Include Firebase scripts -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <!-- Include JsBarcode library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsbarcode/3.11.5/JsBarcode.all.min.js" integrity="sha512-QEAheCz+x/VkKtxeGoDq6nsGyzTx/0LMINTgQjqZ0h3+NjP+bCsPYz3hn0HnBkGmkIFSr7QcEZT+KyEM7lbLPQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>

<body>
    <h1>My Purchase</h1>
    <form onsubmit="return fetchPurchase()">
        <label for="phoneNumber">Enter your phone number:</label>
        <input type="text" id="phoneNumber" name="phoneNumber" required>
        <button type="submit">Submit</button>
    </form>
    <!-- Add a container for the barcode -->
    <canvas id="barcodeContainer"></canvas>
     <div id="displayValue"></div>

    <script>
        // Initialize Firebase
        var firebaseConfig = {
            apiKey: "AIzaSyBo8djp3hGPhsB-96McKlhXZf1A05ZXHo8",
            authDomain: "devops-10d92.firebaseapp.com",
            databaseURL: "https://devops-10d92defaultrtdb.asiasoutheast1.firebasedatabase.app",
            projectId: "devops-10d92",
            storageBucket: "devops-10d92.appspot.com",
            messagingSenderId: "658512427596",
            appId: "1:658512427596:web:7c952bea1f04f6abc312e9",
            measurementId: "G-FPX12XED41"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        db.settings({});

         function fetchPurchase() {
            const phoneNumber = document.getElementById('phoneNumber').value;
            
                const docRef = db.collection("test").doc(phoneNumber);
                const docSnapshot = docRef.get();
            const displayDiv = document.getElementById('displayValue');
                if (docSnapshot.exists) {
                    var barcodeData = docSnapshot.data().barcode;
                    // Clear previous barcode if any
                    // Render barcode onto the container
                    JsBarcode("#barcodeContainer", barcodeData.toString());
                    
                } else {
                    alert("No purchase made yet for this phone number.");
                }
            
            return false; // Prevent form submission
        }
    </script>
</body>


</html>
